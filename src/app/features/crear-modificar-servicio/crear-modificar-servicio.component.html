<h1 mat-dialog-title>{{isEdit? "Modificar" : "Agregar"}} Servicio</h1>
<div mat-dialog-content class="mat-typography">
	<form [formGroup]="myForm">
		<section>
			<mat-form-field appearance="fill" style="padding: 20px;">
				<mat-label>Fecha</mat-label>
				<input matInput [matDatepicker]="picker" formControlName="fecha">
				<mat-hint>MM/DD/YYYY</mat-hint>
				<mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
				<mat-datepicker #picker></mat-datepicker>
			</mat-form-field>
		</section>
		<section>
			<mat-label>Observación</mat-label>
			<mat-form-field class="observacion" appearance="fill" style="padding: 20px;">
				<input [readonly]="isEdit ? true : false" formControlName="observacion" ngDefaultControl matInput>
			</mat-form-field>
		</section>
		<section>
			<mat-form-field style="width: 100%" appearance="fill">
				<mat-label>Empleado</mat-label>
				<mat-select formControlName="empleado">
					<mat-option *ngFor="let item of usuarios$ | async; let i = index" [value]="item.idPersona">
						{{ item.nombre }} {{ item.apellido }}
					</mat-option>
				</mat-select>
			</mat-form-field>

			<mat-form-field style="width: 100%" appearance="fill">
				<mat-label>Cliente</mat-label>
				<mat-select formControlName="cliente">
					<mat-option *ngFor="let item of usuarios$ | async; let i = index" [value]="item.idPersona">
						{{ item.nombre }} {{ item.apellido }}
					</mat-option>
				</mat-select>
			</mat-form-field>
		</section>

		<section>
			<button (click)="reset()" mat-raised-button color="danger">
				Resetear
			  </button>
		</section>

		<section>
			<div style="width: 100%;" class="mat-elevation-z8 p-col-12 p-md-12 p-lg-9">
				<table mat-table [dataSource]="matTableDataSource">
					<ng-container matColumnDef="idficha">
						<th mat-header-cell *matHeaderCellDef>Id ficha</th>
						<td mat-cell *matCellDef="let element">
							{{ element.fechaHora | date: "medium" }}
						</td>
					</ng-container>
					<ng-container matColumnDef="fechacategoria">
						<th mat-header-cell *matHeaderCellDef>Fecha Categoria</th>
						<td mat-cell *matCellDef="let element">
							{{ element.idEmpleado.nombre }} {{ element.idEmpleado.apellido }}
						</td>
					</ng-container>
					<ng-container matColumnDef="subcategoria">
						<th mat-header-cell *matHeaderCellDef>Subcategoria</th>
						<td mat-cell *matCellDef="let element">
							{{ element.idCliente.nombre }} {{ element.idCliente.apellido }}
						</td>
					</ng-container>
					<ng-container matColumnDef="acciones">
						<th mat-header-cell *matHeaderCellDef>Seleccionar ficha</th>
						<td mat-cell *matCellDef="let element">
							<mat-radio-group aria-label="Select an option" [(ngModel)]="selectedFicha" [ngModelOptions]="{
								standalone: true
							}">
								<mat-radio-button [value]="element.idFichaClinica"></mat-radio-button>
							  </mat-radio-group>
						</td>
					</ng-container>

					<tr mat-header-row *matHeaderRowDef="displayedColumnsService"></tr>
					<tr mat-row *matRowDef="let row; columns: displayedColumnsService"></tr>
					<tr class="mat-row" *matNoDataRow>
						<td class="mat-cell" [attr.colspan]="displayedColumnsService.length">
							No se encontraron datos para el filtro.
						</td>
					</tr>
				</table>
				<mat-paginator [pageSizeOptions]="[5, 10]" showFirstLastButtons
					aria-label="Select page of periodic elements">
				</mat-paginator>
			</div>
		</section>
		<section style="padding-top: 20px;">
			<mat-card-title>Detalles</mat-card-title>
		</section>
		<section>
			<mat-form-field style="width: 100%" appearance="fill">
				<mat-label>Categoria</mat-label>
				<mat-select formControlName="categoria">
					<mat-option *ngFor="let item of categorias$ | async; let i = index" [value]="item.idCategoria">
						{{ item.descripcion }}
					</mat-option>
				</mat-select>
			</mat-form-field>
		</section>
		<section>
			<mat-form-field style="width: 100%" appearance="fill">
				<mat-label>Subcategoría (tipo de producto)</mat-label>
				<mat-select formControlName="subcategoria">
					<mat-option *ngFor="let item of subCategorias$ | async; let i = index" [value]="item.idTipoProducto">
						{{ item.descripcion }}
					</mat-option>
				</mat-select>
			</mat-form-field>
		</section>
		<section>
			<mat-form-field style="width: 100%" appearance="fill">
				<mat-label>Tipo de servicio (presentación)</mat-label>
				<mat-select formControlName="empleado">
					<mat-option *ngFor="let item of usuarios$ | async; let i = index" [value]="item.idPersona">
						{{ item.nombre }} {{ item.apellido }}
					</mat-option>
				</mat-select>
			</mat-form-field>
		</section>
		<section>
			<mat-form-field appearance="fill">
				<input matInput disabled value="precio">
			</mat-form-field>
		</section>
		<section>
			<mat-form-field appearance="fill">
				<input matInput value="Cantidad">
			</mat-form-field>
		</section>
		<button mat-raised-button color="primary" >
			Agregar detalle
		</button>
		<section>
			<div class="mat-elevation-z8 p-col-12 p-md-12 p-lg-9">
				<table mat-table [dataSource]="matTableDataSourceDetalle">
					<ng-container matColumnDef="iddetalle">
						<th mat-header-cell *matHeaderCellDef>Id detalle</th>
						<td mat-cell *matCellDef="let element">
							{{ element.fechaHora | date: "medium" }}
						</td>
					</ng-container>
					<ng-container matColumnDef="presentacion">
						<th mat-header-cell *matHeaderCellDef>Presentación</th>
						<td mat-cell *matCellDef="let element">
							{{ element.idEmpleado.nombre }} {{ element.idEmpleado.apellido }}
						</td>
					</ng-container>
					<ng-container matColumnDef="preciounitario">
						<th mat-header-cell *matHeaderCellDef>Precio Unitario</th>
						<td mat-cell *matCellDef="let element">
							{{ element.idCliente.nombre }} {{ element.idCliente.apellido }}
						</td>
					</ng-container>
					<ng-container matColumnDef="cantidad">
						<th mat-header-cell *matHeaderCellDef>cantidad</th>
						<td mat-cell *matCellDef="let element">
							{{ element.idTipoProducto.idCategoria.descripcion }}
						</td>
					</ng-container>
					<ng-container matColumnDef="total">
						<th mat-header-cell *matHeaderCellDef>total</th>
						<td mat-cell *matCellDef="let element">
							{{ element.idTipoProducto.descripcion }}
						</td>
					</ng-container>
					<ng-container matColumnDef="acciones">
						<th mat-header-cell *matHeaderCellDef>Acciones</th>
						<td mat-cell *matCellDef="let element">
							<mat-icon aria-hidden="false" aria-label="Example home icon" fontIcon="edit"></mat-icon>
							<mat-icon aria-hidden="false" aria-label="Example home icon" fontIcon="delete"></mat-icon>
						</td>
					</ng-container>

					<tr mat-header-row *matHeaderRowDef="displayedColumnsDetalle"></tr>
					<tr mat-row *matRowDef="let row; columns: displayedColumnsDetalle"></tr>
					<tr class="mat-row" *matNoDataRow>
						<td class="mat-cell" [attr.colspan]="displayedColumnsDetalle.length">
							No se encontraron datos para el filtro.
						</td>
					</tr>
				</table>
				<mat-paginator [pageSizeOptions]="[5, 10]" showFirstLastButtons
					aria-label="Select page of periodic elements">
				</mat-paginator>
			</div>
			<button mat-raised-button color="primary">
				Cancelar
			</button>
		</section>
	</form>
</div>
<div mat-dialog-actions>
	<button mat-button (click)="onNoClick()">Cancelar</button>
	<button mat-button (click)=modificarServicio() cdkFocusInitial>{{isEdit?"Modificar":"Agregar"}}</button>
</div>